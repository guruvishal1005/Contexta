{
  "id": "malware-containment",
  "name": "Malware Containment Playbook",
  "description": "Standard playbook for containing malware incidents",
  "version": "1.0",
  "category": "containment",
  "severity_threshold": "medium",
  "steps": [
    {
      "order": 1,
      "name": "Isolate Affected System",
      "description": "Disconnect the affected system from the network",
      "action_type": "manual",
      "timeout_minutes": 15,
      "required": true
    },
    {
      "order": 2,
      "name": "Preserve Evidence",
      "description": "Capture memory dump and disk image before remediation",
      "action_type": "manual",
      "timeout_minutes": 60,
      "required": true
    },
    {
      "order": 3,
      "name": "Identify Malware Type",
      "description": "Run malware analysis tools to identify the threat",
      "action_type": "automated",
      "automation_script": "analyze_malware.py",
      "timeout_minutes": 30,
      "required": true
    },
    {
      "order": 4,
      "name": "Block IOCs",
      "description": "Add identified IOCs to blocklists",
      "action_type": "automated",
      "automation_script": "block_iocs.py",
      "timeout_minutes": 10,
      "required": true
    },
    {
      "order": 5,
      "name": "Scan Related Systems",
      "description": "Scan systems that communicated with affected host",
      "action_type": "automated",
      "automation_script": "network_scan.py",
      "timeout_minutes": 60,
      "required": false
    },
    {
      "order": 6,
      "name": "Remediate System",
      "description": "Remove malware or reimage system",
      "action_type": "manual",
      "timeout_minutes": 120,
      "required": true
    },
    {
      "order": 7,
      "name": "Restore Network Access",
      "description": "Reconnect system after verification",
      "action_type": "manual",
      "timeout_minutes": 15,
      "required": true
    }
  ],
  "escalation_rules": [
    {
      "condition": "step_failed",
      "action": "notify_manager"
    },
    {
      "condition": "timeout_exceeded",
      "action": "escalate_to_ir_team"
    }
  ],
  "notifications": {
    "on_start": ["soc_team"],
    "on_complete": ["soc_team", "management"],
    "on_failure": ["ir_lead", "management"]
  }
}
